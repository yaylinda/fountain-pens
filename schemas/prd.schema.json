{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://claudia.contrived.com/schemas/prd.schema.json",
  "title": "Claudia PRD",
  "description": "Product Requirements Document for Claudia-managed repositories",
  "type": "object",
  "required": ["project", "userStories"],
  "properties": {
    "project": {
      "type": "string",
      "description": "Repository name (used in task ID prefix)",
      "pattern": "^[a-z0-9_-]+$"
    },
    "version": {
      "type": "string",
      "description": "PRD version (semver)",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "branchName": {
      "type": "string",
      "description": "Git branch to work on",
      "default": "main"
    },
    "userStories": {
      "type": "array",
      "description": "List of tasks for claudia to complete",
      "items": {
        "$ref": "#/$defs/userStory"
      },
      "minItems": 0
    }
  },
  "$defs": {
    "userStory": {
      "type": "object",
      "required": ["id", "title", "acceptanceCriteria", "priority", "passes"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Task ID in format {project}-{5-digit-number}",
          "pattern": "^[a-z0-9_-]+-\\d{5}$"
        },
        "title": {
          "type": "string",
          "description": "Short task title",
          "minLength": 1,
          "maxLength": 200
        },
        "acceptanceCriteria": {
          "type": "array",
          "description": "List of criteria that must be met",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "priority": {
          "type": "integer",
          "description": "Priority order (lower = higher priority, 0 allowed for fix tasks)",
          "minimum": 0
        },
        "passes": {
          "type": "boolean",
          "description": "Whether the task has been completed"
        },
        "blocked": {
          "type": "boolean",
          "description": "Whether the task is blocked and requires human intervention"
        },
        "blockedReason": {
          "type": "string",
          "description": "Explanation of why the task is blocked and what human action is needed"
        },
        "notes": {
          "type": "string",
          "description": "Optional notes or context for the task"
        }
      }
    }
  }
}
